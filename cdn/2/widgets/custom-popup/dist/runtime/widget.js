System.register(["jimu-core","jimu-arcgis","esri/Graphic"],(function(e,t){var r={},o={},i={};return{setters:[function(e){r.React=e.React,r.jsx=e.jsx},function(e){o.JimuMapViewComponent=e.JimuMapViewComponent},function(e){i.default=e.default}],execute:function(){e((()=>{var e={89:e=>{"use strict";e.exports=i},244:e=>{"use strict";e.exports=r},686:e=>{"use strict";e.exports=o}},t={};function s(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.p="";var n={};return s.p=window.jimuConfig.baseUrl,(()=>{"use strict";s.r(n),s.d(n,{__set_webpack_public_path__:()=>a,default:()=>i});var e=s(244),t=s(686),r=s(89),o=function(e,t,r,o){return new(r||(r=Promise))((function(i,s){function n(e){try{c(o.next(e))}catch(e){s(e)}}function a(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(n,a)}c((o=o.apply(e,t||[])).next())}))};function i(i){var s;console.log("\u{1f9e9} Custom Popup Widget Loaded!");const[n,a]=e.React.useState(null),[c,l]=e.React.useState(null),u=e.React.useRef(null),d=e.React.useCallback((()=>{if(u.current){try{u.current.remove()}catch(e){}u.current=null}}),[]);e.React.useEffect((()=>()=>{d()}),[d]);const p=e=>{if(!e)return{isOpen:!1,text:"Unknown"};const t=e.toLowerCase().includes("closed");return{isOpen:!t,text:t?"Closed":"Open"}},g=null===(s=i.config)||void 0===s?void 0:s.sourceMapWidgetId;return(0,e.jsx)("div",{className:"p-3 space-y-3",css:{fontFamily:"Segoe UI, sans-serif",lineHeight:1.4,color:"#333",height:"100%",display:"flex",flexDirection:"column"}},g&&(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:g,onActiveViewChange:e=>{if(console.log("\u{1f517} Active view change triggered:",e),d(),!e)return;a(e);const t=e.view;t.when((()=>{console.log("\u2705 MapView is ready, attaching click handler..."),u.current=t.on("click",(e=>o(this,void 0,void 0,(function*(){var o,i;console.log("\u{1f5b1}\ufe0f Map clicked at:",e.mapPoint);try{const s=yield t.hitTest(e);console.log("\u{1f3af} HitTest results:",(null===(o=s.results)||void 0===o?void 0:o.length)||0);const n=s.results.find((e=>{var t;return e.graphic&&"feature"===(null===(t=e.graphic.layer)||void 0===t?void 0:t.type)}));if(!n)return console.log("\u274c No feature layer found at click point."),void l(null);const a=n.graphic.layer,c=n.graphic;console.log("\u2705 Target layer feature found:"),console.log("   Layer:",a.title),console.log("   Attributes:",c.attributes),console.log("   Geometry type:",null===(i=c.geometry)||void 0===i?void 0:i.type);let u=c.attributes;try{const e=a.objectIdField||"FID",t=c.attributes[e];console.log("\u{1f50d} Querying full feature by OID:",t);const r=yield a.queryFeatures({objectIds:[t],outFields:["*"],returnGeometry:!1});r.features.length>0?(u=r.features[0].attributes,console.log("\u2705 Full feature attributes:",u)):console.log("\u274c No additional attributes found via query.")}catch(e){console.error("\u26a0\ufe0f Query failed:",e)}const d=new r.default({geometry:c.geometry,symbol:{type:"simple-marker",color:[255,0,0,.6],outline:{color:[255,255,255],width:2}}});t.graphics.removeAll(),t.graphics.add(d),l({attributes:u,layerTitle:a.title,geometry:c.geometry})}catch(e){console.error("\u26a0\ufe0f Error during hitTest:",e)}}))))}))}}),c&&(0,e.jsx)("div",{css:{flex:"1",display:"flex",flexDirection:"column",minHeight:"0"}},(0,e.jsx)("div",{css:{display:"flex",flexDirection:"column",gap:"10px",padding:"16px",borderRadius:"8px",background:"white",border:"1px solid #e1e1e1",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",height:"400px",overflowY:"auto",overflowX:"hidden","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{background:"#f1f1f1",borderRadius:"3px"},"&::-webkit-scrollbar-thumb":{background:"#c1c1c1",borderRadius:"3px","&:hover":{background:"#a8a8a8"}}}},(0,e.jsx)("h5",{css:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"600",color:"#1a1a1a",position:"sticky",top:"0",background:"white",paddingBottom:"8px",zIndex:1}},c.attributes.Organization_name||"Unnamed Feature"),(0,e.jsx)("div",{css:{marginBottom:"4px"}},(0,e.jsx)("p",{css:{margin:"0 0 4px 0",fontSize:"13px",color:"#555"}},c.attributes.Physical_Address||c.attributes.Street_Address||"Address not available"),(0,e.jsx)("p",{css:{margin:"0",fontSize:"13px",fontWeight:"600",color:p(c.attributes.Operating_Hours).isOpen?"#388e3c":"#d32f2f"}},p(c.attributes.Operating_Hours).text)),c.attributes.Operating_Hours&&(0,e.jsx)("div",{css:{fontSize:"12px",color:"#666",background:"#f8f9fa",borderRadius:"4px",padding:"6px 8px"}},(0,e.jsx)("strong",null,"Hours:")," ",c.attributes.Operating_Hours),(0,e.jsx)("div",{css:{border:"1px solid #eee",borderRadius:"8px",padding:"12px",background:"#fafafa"}},(0,e.jsx)("div",{css:{fontSize:"12px",color:"#777",marginBottom:"8px",textTransform:"uppercase",letterSpacing:"0.5px",fontWeight:"600"}},"Services Offered"),(0,e.jsx)("ul",{css:{margin:"0",paddingLeft:"18px",listStyleType:"disc",fontSize:"13px"}},(e=>{if(!e||""===e.trim())return["No services listed"];const t=e.split(/[,;]/).map((e=>e.trim())).filter((e=>""!==e));return t.length>0?t:["No services listed"]})(c.attributes.ServicesOffered).map(((t,r)=>(0,e.jsx)("li",{key:r,css:{margin:"4px 0",lineHeight:"1.4",color:"No services listed"===t?"#999":"#333"}},t))))),(0,e.jsx)("div",{css:{display:"flex",flexDirection:"column",gap:"8px",fontSize:"13px"}},c.attributes.Languages_Supported_&&(0,e.jsx)("div",{css:{background:"#f8f9fa",padding:"8px",borderRadius:"4px"}},(0,e.jsx)("strong",null,"Languages:")," ",c.attributes.Languages_Supported_),c.attributes.Immigration_Status_Supported&&(0,e.jsx)("div",{css:{background:"#f8f9fa",padding:"8px",borderRadius:"4px"}},(0,e.jsx)("strong",null,"Supports:")," ",c.attributes.Immigration_Status_Supported),c.attributes.Price&&(0,e.jsx)("div",{css:{background:"#f8f9fa",padding:"8px",borderRadius:"4px"}},(0,e.jsx)("strong",null,"Cost:")," ",c.attributes.Price),c.attributes.Physical_Accessibility&&(0,e.jsx)("div",{css:{background:"#f8f9fa",padding:"8px",borderRadius:"4px"}},(0,e.jsx)("strong",null,"Accessibility:")," ",c.attributes.Physical_Accessibility),c.attributes.Organization_Description&&(0,e.jsx)("div",{css:{background:"#f8f9fa",padding:"8px",borderRadius:"4px",fontStyle:"italic"}},(0,e.jsx)("strong",null,"Description:")," ",c.attributes.Organization_Description)),(()=>{var t;let r=(null===(t=c.attributes.Website)||void 0===t?void 0:t.trim())||"",o=!1;if(r&&"N/A"!==r&&"null"!==r&&"-"!==r){/^https?:\/\//i.test(r)||(r="https://"+r);try{new URL(r),o=!0}catch(e){o=!1}}return(0,e.jsx)("div",{css:{position:"sticky",bottom:"0",background:"white",paddingTop:"8px",marginTop:"auto"}},(0,e.jsx)("a",{href:o?r:void 0,target:o?"_blank":void 0,rel:o?"noopener noreferrer":void 0,css:{display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"6px",width:"100%",padding:"10px",background:o?"#0078d7":"#ccc",color:"white",borderRadius:"6px",textDecoration:"none",fontSize:"13px",fontWeight:"500",transition:"background 0.2s ease",cursor:o?"pointer":"not-allowed",border:"none","&:hover":o?{background:"#005fa3",textDecoration:"none"}:{}},onClick:e=>{o||e.preventDefault()}},o?"View Website":"Website Not Available"))})(),c.attributes.Contact_Info&&(0,e.jsx)("div",{css:{fontSize:"12px",color:"#666",textAlign:"center",padding:"8px 0 0 0",borderTop:"1px solid #eee",marginTop:"8px"}},(0,e.jsx)("strong",null,"Contact:")," ",c.attributes.Contact_Info))))}function a(e){s.p=e}})(),n})())}}}));