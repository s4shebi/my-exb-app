System.register(["jimu-core","jimu-arcgis"],(function(e,t){var o={},i={};return{setters:[function(e){o.DataSourceManager=e.DataSourceManager,o.React=e.React,o.jsx=e.jsx},function(e){i.JimuMapViewComponent=e.JimuMapViewComponent}],execute:function(){e((()=>{var e={56:(e,t,o)=>{"use strict";e.exports=function(e){var t=o.nc;t&&e.setAttribute("nonce",t)}},72:e=>{"use strict";var t=[];function o(e){for(var o=-1,i=0;i<t.length;i++)if(t[i].identifier===e){o=i;break}return o}function i(e,i){for(var n={},a=[],s=0;s<e.length;s++){var l=e[s],c=i.base?l[0]+i.base:l[0],u=n[c]||0,d="".concat(c," ").concat(u);n[c]=u+1;var p=o(d),g={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==p)t[p].references++,t[p].updater(g);else{var f=r(g,i);i.byIndex=s,t.splice(s,0,{identifier:d,updater:f,references:1})}a.push(d)}return a}function r(e,t){var o=t.domAPI(t);o.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;o.update(e=t)}else o.remove()}}e.exports=function(e,r){var n=i(e=e||[],r=r||{});return function(e){e=e||[];for(var a=0;a<n.length;a++){var s=o(n[a]);t[s].references--}for(var l=i(e,r),c=0;c<n.length;c++){var u=o(n[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}n=l}}},113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},133:(e,t,o)=>{"use strict";o.d(t,{A:()=>s});var i=o(601),r=o.n(i),n=o(314),a=o.n(n)()(r());a.push([e.id,".custom-sidebar-root{height:100% !important;min-height:100% !important;min-height:100vh;min-height:100dvh;width:100%;align-self:stretch;display:flex;flex-direction:column;box-sizing:border-box}.jimu-widget .custom-sidebar-root,.widget-wrapper .custom-sidebar-root{align-self:stretch}.app-root-emotion-cache-ltr-e1j3ec{display:none !important;height:0 !important;width:0 !important;visibility:hidden !important;position:absolute !important}.custom-sidebar-root{height:100% !important;display:flex !important;flex-direction:column !important}.custom-sidebar-root>div:empty{display:none !important}",""]);const s=a},244:e=>{"use strict";e.exports=o},314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var o="",i=void 0!==t[5];return t[4]&&(o+="@supports (".concat(t[4],") {")),t[2]&&(o+="@media ".concat(t[2]," {")),i&&(o+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),o+=e(t),i&&(o+="}"),t[2]&&(o+="}"),t[4]&&(o+="}"),o})).join("")},t.i=function(e,o,i,r,n){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(i)for(var s=0;s<this.length;s++){var l=this[s][0];null!=l&&(a[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);i&&a[u[0]]||(void 0!==n&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=n),o&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=o):u[2]=o),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601:e=>{"use strict";e.exports=function(e){return e[1]}},659:e=>{"use strict";var t={};e.exports=function(e,o){var i=function(e){if(void 0===t[e]){var o=document.querySelector(e);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(e){o=null}t[e]=o}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(o)}},686:e=>{"use strict";e.exports=i},825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(o){!function(e,t,o){var i="";o.supports&&(i+="@supports (".concat(o.supports,") {")),o.media&&(i+="@media ".concat(o.media," {"));var r=void 0!==o.layer;r&&(i+="@layer".concat(o.layer.length>0?" ".concat(o.layer):""," {")),i+=o.css,r&&(i+="}"),o.media&&(i+="}"),o.supports&&(i+="}");var n=o.sourceMap;n&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,o)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={id:o,exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="",r.nc=void 0;var n={};return r.p=window.jimuConfig.baseUrl,(()=>{"use strict";r.r(n),r.d(n,{__set_webpack_public_path__:()=>b,default:()=>y});var e=r(244),t=r(686),o=r(72),i=r.n(o),a=r(825),s=r.n(a),l=r(659),c=r.n(l),u=r(56),d=r.n(u),p=r(540),g=r.n(p),f=r(113),v=r.n(f),x=r(133),m={};m.styleTagTransform=v(),m.setAttributes=d(),m.insert=c().bind(null,"head"),m.domAPI=s(),m.insertStyleElement=g();i()(x.A,m);x.A&&x.A.locals&&x.A.locals;var h=function(e,t,o,i){return new(o||(o=Promise))((function(r,n){function a(e){try{l(i.next(e))}catch(e){n(e)}}function s(e){try{l(i.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,s)}l((i=i.apply(e,t||[])).next())}))};function y(o){var i,r;const[n,a]=e.React.useState(null),[s,l]=e.React.useState([]),[c,u]=e.React.useState([]),[d,p]=e.React.useState({location:"",serviceType:"",immigrationStatus:"",hours:"",languages:"",accessibility:"",fees:""}),[g,f]=e.React.useState(null),[v,x]=e.React.useState(!1),[m,y]=e.React.useState(""),[b,w]=e.React.useState(!1),[S,j]=e.React.useState(null),[C,L]=e.React.useState(""),O=e.React.useMemo((()=>{const e=new Set,t=new Set(["and","or","of","the"]);return s.forEach((o=>{var i;const r=(null===(i=null==o?void 0:o.attributes)||void 0===i?void 0:i.Physical_Accessibility)||"";r&&r.split(/[;,]/).map((e=>e.trim())).filter(Boolean).forEach((o=>{let i=o.replace(/\(.*?\)|\[.*?\]|\{.*?\}/g,"").replace(/\b(e\.?g\.?)\b/gi,"").trim();i=i.toLowerCase().split(/\s+/).map(((e,o)=>t.has(e)&&0!==o?e:e.charAt(0).toUpperCase()+e.slice(1))).join(" "),i=i.replace(/[^a-zA-Z0-9\s-]/g,"").trim(),i&&e.add(i)}))})),Array.from(e).sort(((e,t)=>e.localeCompare(t)))}),[s]),_=e=>{if(!(null==e?void 0:e.view))return;const t=e.view;t.on("click",(e=>{console.log("\u{1f5fa}\ufe0f Map clicked at:",e.mapPoint),t.hitTest(e).then((e=>{if(e.results.length>0){const t=e.results.filter((e=>e.graphic));if(t.length>0){const e=t[0].graphic.attributes;console.log("\u{1f3af} Found graphic with attributes:",e);const o=s.find((t=>t.attributes.FID===e.FID||t.attributes.Organization_name===e.Organization_name));o?(console.log("\u2705 Found matching organization:",o.attributes.Organization_name),I(o)):console.log("\u274c No matching organization found for clicked feature")}}})).catch((e=>{console.error("\u274c Error during hit test:",e)}))}))},I=e=>{f(e),j(e),setTimeout((()=>{const t=document.getElementById(`org-${e.attributes.FID}`);t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),t.style.transition="all 0.3s ease",t.style.boxShadow="0 0 0 3px rgba(0, 120, 215, 0.3)",setTimeout((()=>{t.style.boxShadow=""}),2e3))}),100)},E=e=>h(this,void 0,void 0,(function*(){w(!0);try{console.log("\u{1f50d} Auto-detecting data source from map...");const t=e.view;if(!(null==t?void 0:t.map))return void console.log("\u274c No map found in view");yield t.when(),yield new Promise((e=>setTimeout(e,1e3)));const o=t.map.allLayers.toArray();if(console.log("\u{1f5fa}\ufe0f Map layers:",o.length),0===o.length)return console.log("\u26a0\ufe0f No layers found in map yet, waiting..."),void setTimeout((()=>E(e)),2e3);o.forEach(((e,t)=>{const o={title:(null==e?void 0:e.title)||"No title",type:(null==e?void 0:e.type)||"Unknown type",url:(null==e?void 0:e.url)||"No URL",id:(null==e?void 0:e.id)||"No ID",loaded:(null==e?void 0:e.loaded)||!1,hasQueryFeatures:"function"==typeof(null==e?void 0:e.queryFeatures)};console.log(`Layer ${t}:`,o)}));const i=o.filter((e=>"feature"===(null==e?void 0:e.type)&&"function"==typeof(null==e?void 0:e.queryFeatures)&&e.loaded));if(console.log("\u{1f3af} Loaded feature layers found:",i.length),i.length>0){const e=i[0],t=(null==e?void 0:e.title)||(null==e?void 0:e.id)||"Unknown Layer";console.log("\u2705 Using feature layer:",t),console.log("\u{1f50d} Layer object:",e),yield R(e)}else{console.log("\u26a0\ufe0f No loaded feature layers found, checking for unloaded layers...");const t=o.filter((e=>"feature"===(null==e?void 0:e.type)&&"function"==typeof(null==e?void 0:e.queryFeatures)&&!e.loaded));if(t.length>0){console.log("\u23f3 Found unloaded feature layers, waiting for them to load...");const o=t.map((e=>e.when()));yield Promise.all(o),E(e)}else y("No feature layers found in the map. Please add a feature layer with organization data or configure a data source in settings.")}}catch(e){console.error("\u274c Error auto-detecting data source:",e),y(`Failed to auto-detect data source from map: ${e.message}`)}})),R=e=>h(this,void 0,void 0,(function*(){var t,o;if(!e)return console.error("\u274c Layer is undefined in loadDataFromLayer"),void y("Layer reference is missing. Please try configuring a data source in settings.");x(!0),y("");try{const i=(null==e?void 0:e.title)||(null==e?void 0:e.id)||"Unknown Layer";if(console.log("\u{1f4e5} Loading data from layer:",i),e.loaded||(console.log("\u23f3 Waiting for layer to load..."),yield e.when()),"function"!=typeof e.queryFeatures)throw new Error("Layer does not support querying");const r=(null===(t=e.createQuery)||void 0===t?void 0:t.call(e))||{};r.where="1=1",r.outFields=["*"],r.returnGeometry=!0,r.outFields=["FID","Organization_name","Physical_Address","ServicesOffered","Immigration_Status_Supported","Operating_Hours","Languages_Supported_","Physical_Accessibility","Price","Website","Contact_Info","City","Province"],console.log("\u{1f50d} Executing query on layer:",i);const n=yield e.queryFeatures(r);if(console.log("\u2705 Query completed, features found:",(null===(o=n.features)||void 0===o?void 0:o.length)||0),!n.features||0===n.features.length)return y("No organizations found in the selected layer. The layer might be empty."),l([]),void u([]);const a=n.features.map((e=>({attributes:e.attributes||{},geometry:e.geometry})));console.log(`\u2705 Loaded ${a.length} organizations from layer`),l(a),u(a)}catch(e){console.error("\u274c Error loading data from layer:",e),y(`Failed to load data from layer: ${e.message}`)}finally{x(!1)}}));e.React.useEffect((()=>{(()=>{h(this,void 0,void 0,(function*(){var t,i;if(null===(i=null===(t=o.useDataSources)||void 0===t?void 0:t[0])||void 0===i?void 0:i.dataSourceId){x(!0),y("");try{console.log("\u{1f4e5} Fetching from configured data source:",o.useDataSources[0].dataSourceId);const t=yield e.DataSourceManager.getInstance().getDataSource(o.useDataSources[0].dataSourceId);if(t){console.log("\u2705 Data source found");const e={where:"1=1",outFields:["*"],returnGeometry:!0},o=yield t.query(e);console.log("\u{1f4ca} Records found:",o.records.length);const i=o.records.map((e=>({attributes:e.getData(),geometry:e.getGeometry()})));console.log(`\u2705 Loaded ${i.length} organizations from data source`),l(i),u(i)}else y("Configured data source not found. Please check the data source configuration.")}catch(e){console.error("\u274c Error fetching organizations:",e),y(`Error loading data: ${e.message}`)}finally{x(!1)}}else console.log("\u23f3 No data source configured - will try auto-detection")}))})()}),[o.useDataSources]),e.React.useEffect((()=>{n&&s.length>0&&_(n)}),[n,s]),e.React.useEffect((()=>{let e=[...s];d.location&&(e=e.filter((e=>{var t,o;return(null===(t=e.attributes.City)||void 0===t?void 0:t.toLowerCase().includes(d.location.toLowerCase()))||(null===(o=e.attributes.Physical_Address)||void 0===o?void 0:o.toLowerCase().includes(d.location.toLowerCase()))}))),d.serviceType&&(e=e.filter((e=>{var t;return null===(t=e.attributes.ServicesOffered)||void 0===t?void 0:t.toLowerCase().includes(d.serviceType.toLowerCase())}))),d.immigrationStatus&&(e=e.filter((e=>{var t;return null===(t=e.attributes.Immigration_Status_Supported)||void 0===t?void 0:t.toLowerCase().includes(d.immigrationStatus.toLowerCase())}))),d.hours&&(e=e.filter((e=>{const t=z(e.attributes.Operating_Hours||"");return"open"===d.hours?t.isOpen:"closed"!==d.hours||!t.isOpen}))),d.languages&&(e=e.filter((e=>{var t;return null===(t=e.attributes.Languages_Supported_)||void 0===t?void 0:t.toLowerCase().includes(d.languages.toLowerCase())}))),d.accessibility&&(e=e.filter((e=>{var t;return null===(t=e.attributes.Physical_Accessibility)||void 0===t?void 0:t.toLowerCase().includes(d.accessibility.toLowerCase())}))),d.fees&&(e=e.filter((e=>{var t;const o=(null===(t=e.attributes.Price)||void 0===t?void 0:t.toLowerCase())||"";return"free"===d.fees?o.includes("free"):"paid"!==d.fees||!o.includes("free")&&o.length>0}))),C&&(e=e.filter((e=>{var t,o,i,r;const n=C.toLowerCase(),a=e.attributes;return(null===(t=a.Organization_name)||void 0===t?void 0:t.toLowerCase().includes(n))||(null===(o=a.ServicesOffered)||void 0===o?void 0:o.toLowerCase().includes(n))||(null===(i=a.Immigration_Status_Supported)||void 0===i?void 0:i.toLowerCase().includes(n))||(null===(r=a.Languages_Supported_)||void 0===r?void 0:r.toLowerCase().includes(n))}))),u(e)}),[d,s,C]);const z=e=>{const t=new Date,o=(t.toLocaleString("en-US",{weekday:"long"}).toLowerCase(),60*t.getHours()+t.getMinutes()),i=(null==e?void 0:e.toLowerCase())||"";if(!e||i.includes("closed")||i.includes("holiday"))return{isOpen:!1,text:"Closed",color:"#dc2626"};const r=i.match(/(\d{1,2}(:\d{2})?\s*(am|pm))\s*[-\u2013to]+\s*(\d{1,2}(:\d{2})?\s*(am|pm))/);if(r){const[,e,,,t]=r,i=e=>{const[t,o]=e.split(/(am|pm)/);let[i,r]=t.trim().split(":").map(Number);return r||(r=0),"pm"===o&&i<12&&(i+=12),"am"===o&&12===i&&(i=0),60*i+r},n=i(e),a=i(t),s=o>=n&&o<=a;return{isOpen:s,text:s?"Open":"Closed",color:s?"#16a34a":"#dc2626"}}return{isOpen:!1,text:"Closed",color:"#dc2626"}},F=e=>e?e.split(/[,;]/).map((e=>e.trim())).filter((e=>e)).slice(0,3):[],k=(e,t)=>{p((o=>Object.assign(Object.assign({},o),{[e]:t})))};e.React.useEffect((()=>{var e;if(!(null===(e=null==n?void 0:n.view)||void 0===e?void 0:e.map))return;const t=n.view,o=t.map.allLayers.find((e=>"feature"===e.type));if(!o)return;let i="1=1";const r=[],a=e=>e.toLowerCase().replace(/'/g,"''");if(d.location){const e=a(d.location);r.push(`(LOWER(City) LIKE '%${e}%' OR LOWER(Physical_Address) LIKE '%${e}%')`)}if(d.serviceType){const e=a(d.serviceType);r.push(`LOWER(ServicesOffered) LIKE '%${e}%'`)}if(d.immigrationStatus){const e=a(d.immigrationStatus);r.push(`LOWER(Immigration_Status_Supported) LIKE '%${e}%'`)}if(d.languages){const e=a(d.languages);r.push(`LOWER(Languages_Supported_) LIKE '%${e}%'`)}if(d.accessibility){const e=a(d.accessibility);r.push(`LOWER(Physical_Accessibility) LIKE '%${e}%'`)}if(d.fees&&("free"===d.fees?r.push("LOWER(Price) LIKE '%free%'"):"paid"===d.fees&&r.push("LOWER(Price) NOT LIKE '%free%'")),C){const e=a(C);r.push(`(LOWER(Organization_name) LIKE '%${e}%' OR LOWER(ServicesOffered) LIKE '%${e}%' OR LOWER(Immigration_Status_Supported) LIKE '%${e}%' OR LOWER(Languages_Supported_) LIKE '%${e}%')`)}r.length>0&&(i=r.join(" AND ")),console.log("\u{1f9e9} Applying filter to layer:",i),o.definitionExpression=i,o.queryExtent({where:i}).then((e=>{e.extent?t.goTo(e.extent.expand(1.2),{animate:!0}):console.log("\u26a0\ufe0f No matching features to zoom to")})).catch((e=>{console.warn("\u26a0\ufe0f Error adjusting extent:",e)})),(()=>{h(this,void 0,void 0,(function*(){var e,r;try{const n=yield t.whenLayerView(o);if(!d.hours)return void(n.filter=null);const a=o.objectIdField||"OBJECTID",s=(null===(r=(e=o).createQuery)||void 0===r?void 0:r.call(e))||{};s.where=i,s.outFields=[a,"Operating_Hours"],s.returnGeometry=!1;const l=((yield o.queryFeatures(s)).features||[]).filter((e=>{var t;const o=z((null===(t=e.attributes)||void 0===t?void 0:t.Operating_Hours)||"");return"open"===d.hours?o.isOpen:!o.isOpen})).map((e=>{var t;return null===(t=e.attributes)||void 0===t?void 0:t[a]})).filter((e=>null!=e));n.filter={objectIds:l}}catch(e){console.warn("\u26a0\ufe0f Hours LayerView filter failed:",e)}}))})()}),[d,n,C]);const A=null===(i=o.config)||void 0===i?void 0:i.sourceMapWidgetId;return(0,e.jsx)("div",{className:"custom-sidebar-root",css:{display:"flex",flexDirection:"column",height:"100vh",width:"100%",fontFamily:"Segoe UI, sans-serif",backgroundColor:"white"}},(0,e.jsx)("header",{css:{backgroundColor:"white",borderBottom:"1px solid #e5e7eb",padding:"16px 20px",flexShrink:0}},(0,e.jsx)("div",{css:{marginBottom:"12px"}},(0,e.jsx)("h1",{css:{fontSize:"16px",fontWeight:"400",color:"#6b7280",margin:"0"}},(0,e.jsx)("span",{css:{color:"#0078d7",fontWeight:"600"}},c.length)," Organizations Found")),m&&(0,e.jsx)("div",{css:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",color:"#dc2626",padding:"8px 12px",borderRadius:"6px",fontSize:"12px",marginBottom:"12px"}},"\u26a0\ufe0f ",m),!(null===(r=o.useDataSources)||void 0===r?void 0:r[0])&&!m&&0===s.length&&(0,e.jsx)("div",{css:{backgroundColor:"#fffbeb",border:"1px solid #fed7aa",color:"#ea580c",padding:"8px 12px",borderRadius:"6px",fontSize:"12px",marginBottom:"12px"}},"\u23f3 Waiting for data source (select one in settings or let it auto-detect from the map)..."),(0,e.jsx)("div",{css:{display:s.length>0?"flex":"none",flexDirection:"column",gap:"12px"}},(0,e.jsx)("div",{css:{display:"flex",gap:"8px",flexWrap:"wrap"}},(0,e.jsx)("select",{value:d.serviceType,onChange:e=>k("serviceType",e.target.value),css:{padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",minWidth:"120px",backgroundColor:"white"}},(0,e.jsx)("option",{value:""},"Service Type"),(0,e.jsx)("option",{value:"employment"},"Employment"),(0,e.jsx)("option",{value:"housing"},"Housing"),(0,e.jsx)("option",{value:"education"},"Education"),(0,e.jsx)("option",{value:"language"},"Language"),(0,e.jsx)("option",{value:"legal"},"Legal"),(0,e.jsx)("option",{value:"healthcare"},"Healthcare")),(0,e.jsx)("select",{value:d.location,onChange:e=>k("location",e.target.value),css:{padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",minWidth:"120px",backgroundColor:"white"}},(0,e.jsx)("option",{value:""},"Location"),(0,e.jsx)("option",{value:"edmonton"},"Edmonton"),(0,e.jsx)("option",{value:"calgary"},"Calgary")),(0,e.jsx)("select",{value:d.hours,onChange:e=>k("hours",e.target.value),css:{padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",minWidth:"120px",backgroundColor:"white"}},(0,e.jsx)("option",{value:""},"Availability"),(0,e.jsx)("option",{value:"open"},"Open Now"),(0,e.jsx)("option",{value:"closed"},"Closed")),(0,e.jsx)("select",{value:d.accessibility,onChange:e=>k("accessibility",e.target.value),css:{padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",minWidth:"160px",backgroundColor:"white"}},(0,e.jsx)("option",{value:""},"Accessibility"),O.map((t=>(0,e.jsx)("option",{key:t,value:t.toLowerCase()},t)))),(0,e.jsx)("select",{value:d.fees,onChange:e=>k("fees",e.target.value),css:{padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",backgroundColor:"white"}},(0,e.jsx)("option",{value:""},"All Fees"),(0,e.jsx)("option",{value:"free"},"Free"),(0,e.jsx)("option",{value:"paid"},"Paid"))),(0,e.jsx)("div",{css:{display:"flex",justifyContent:"space-between",alignItems:"center"}},(0,e.jsx)("button",{onClick:()=>{var e;p({location:"",serviceType:"",immigrationStatus:"",hours:"",languages:"",accessibility:"",fees:""}),f(null),j(null);try{(null===(e=null==n?void 0:n.view)||void 0===e?void 0:e.graphics)&&n.view.graphics.removeAll()}catch(e){console.warn("\u26a0\ufe0f Failed to clear map graphics on Clear Filters:",e)}try{window.dispatchEvent(new CustomEvent("clear-custom-selection"))}catch(e){console.warn("\u26a0\ufe0f Failed to dispatch clear-custom-selection event:",e)}},css:{padding:"6px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"12px",backgroundColor:"white",color:"#6b7280",cursor:"pointer","&:hover":{backgroundColor:"#f9fafb"}}},"Clear Filters")))),(0,e.jsx)("div",{css:{display:"flex",flexDirection:"column",flex:1,minHeight:0,overflow:"hidden"}},(0,e.jsx)("div",{css:{padding:"12px 20px",borderBottom:"1px solid #e5e7eb",backgroundColor:"white"}},(0,e.jsx)("input",{type:"text",placeholder:"Search by name, services, population served, or supports...",value:C,onChange:e=>{L(e.target.value)},css:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"13px",outline:"none","&:focus":{borderColor:"#0078d7",boxShadow:"0 0 0 2px rgba(0, 120, 215, 0.1)"}}})),(0,e.jsx)("main",{css:{flex:1,overflowY:"auto",padding:"16px 20px"}},v?(0,e.jsx)("div",{css:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#6b7280"}},"Loading organizations..."):m?(0,e.jsx)("div",{css:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#6b7280",textAlign:"center",flexDirection:"column",gap:"12px"}},(0,e.jsx)("div",null,"\u274c ",m),(0,e.jsx)("div",{css:{fontSize:"12px",color:"#9ca3af"}},"Please configure a data source in the widget settings or ensure your map contains feature layers with organization data.")):0===c.length&&s.length>0?(0,e.jsx)("div",{css:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#6b7280",textAlign:"center"}},"No organizations found matching your filters."):0===s.length?(0,e.jsx)("div",{css:{display:"flex",justifyContent:"center",alignItems:"center",height:"200px",color:"#6b7280",textAlign:"center"}},"No organizations loaded. Please check your data source configuration."):(0,e.jsx)("div",{css:{display:"flex",flexDirection:"column",gap:"16px"}},c.map((t=>(0,e.jsx)("div",{key:t.attributes.FID,id:`org-${t.attributes.FID}`,css:Object.assign({backgroundColor:"white",border:(null==S?void 0:S.attributes.FID)===t.attributes.FID?"2px solid #0078d7":"1px solid #e5e7eb",borderRadius:"8px",padding:"16px",cursor:"pointer",transition:"all 0.2s ease",position:"relative","&:hover":{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",borderColor:"#0078d7"}},(null==g?void 0:g.attributes.FID)===t.attributes.FID&&{borderColor:"#0078d7",boxShadow:"0 0 0 2px rgba(0, 120, 215, 0.1)"}),onClick:()=>(e=>{f(e),j(e);try{const t={attributes:e.attributes,geometry:e.geometry,layerTitle:"Organization"};window.dispatchEvent(new CustomEvent("open-custom-popup",{detail:t}))}catch(e){console.warn("\u26a0\ufe0f Failed to dispatch open-custom-popup event:",e)}n&&e.geometry&&n.view.goTo({target:e.geometry,zoom:14}).catch((e=>{console.warn("\u26a0\ufe0f Could not zoom to organization:",e)}))})(t)},(0,e.jsx)("div",{css:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"12px"}},(0,e.jsx)("h3",{css:{fontSize:"16px",fontWeight:"600",color:"#1f2937",margin:"0",flex:1,lineHeight:"1.4"}},t.attributes.Organization_name||"Unnamed Organization"),(0,e.jsx)("div",{css:{padding:"2px 6px",borderRadius:"8px",fontSize:"10.5px",fontWeight:"600",minWidth:"50px",textAlign:"center",backgroundColor:z(t.attributes.Operating_Hours).color+"20",color:z(t.attributes.Operating_Hours).color,whiteSpace:"nowrap"}},z(t.attributes.Operating_Hours).text)),(0,e.jsx)("div",{css:{display:"flex",alignItems:"flex-start",gap:"6px",marginBottom:"8px",fontSize:"13px",color:"#6b7280"}},(0,e.jsx)("span",null,"\u{1f4cd}"),(0,e.jsx)("span",null,t.attributes.Physical_Address||"Address not available")),t.attributes.ServicesOffered&&(0,e.jsx)("div",{css:{marginBottom:"12px"}},(0,e.jsx)("div",{css:{fontSize:"12px",color:"#6b7280",marginBottom:"4px",fontWeight:"500"}},"Services:"),(0,e.jsx)("div",{css:{display:"flex",flexWrap:"wrap",gap:"4px"}},F(t.attributes.ServicesOffered).map(((t,o)=>(0,e.jsx)("span",{key:o,css:{padding:"2px 6px",backgroundColor:"#f3f4f6",borderRadius:"4px",fontSize:"11px",color:"#4b5563"}},t))),3===F(t.attributes.ServicesOffered).length&&(0,e.jsx)("span",{css:{fontSize:"11px",color:"#9ca3af"}},"+ more"))),(0,e.jsx)("div",{css:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"12px",color:"#6b7280"}},(0,e.jsx)("div",{css:{display:"flex",alignItems:"center",gap:"8px"}},t.attributes.Languages_Supported_&&(0,e.jsx)("span",null,t.attributes.Languages_Supported_.split(",")[0]),t.attributes.Price&&t.attributes.Price.toLowerCase().includes("free")&&(0,e.jsx)("span",null,"Free")))))))),s.length>0&&(0,e.jsx)("footer",{css:{borderTop:"1px solid #e5e7eb",padding:"16px 20px",backgroundColor:"white",flexShrink:0,marginTop:"auto"}},(0,e.jsx)("div",{css:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"14px",color:"#6b7280"}},(0,e.jsx)("div",null,"Showing 1-",c.length," of ",s.length," results")))),A&&(0,e.jsx)("div",{css:{height:"300px",borderTop:"1px solid #e5e7eb",flexShrink:0}},(0,e.jsx)(t.JimuMapViewComponent,{useMapWidgetId:A,onActiveViewChange:e=>{var t;console.log("\u{1f517} Active view change triggered:",e),a(e),e&&_(e),(null===(t=o.useDataSources)||void 0===t?void 0:t[0])||!e||b||setTimeout((()=>{E(e)}),2e3)}})))}function b(e){r.p=e}})(),n})())}}}));